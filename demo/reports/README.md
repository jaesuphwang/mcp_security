# MCP Security Guardian Reports

This directory contains security scan reports generated by the MCP Security Guardian system. Each report is a comprehensive assessment of security issues detected across multiple components.

## Report Format

Reports are saved as JSON files with the following naming convention:
```
security_scan_report_YYYYMMDD_HHMMSS.json
```

## Report Structure

Each report contains the following main sections:

### Metadata

```json
{
  "scan_id": "7dc6134e-dc33-4a81-9a51-bde95c34d02d",
  "timestamp": "2025-05-22T18:37:54.801512"
}
```

- `scan_id`: Unique identifier for the scan
- `timestamp`: ISO-8601 format timestamp when the scan was started

### Summary

```json
"summary": {
  "total_instructions_analyzed": 12,
  "threats_detected": 4,
  "total_vulnerabilities": 8,
  "vulnerabilities_by_severity": {
    "CRITICAL": 1,
    "HIGH": 4,
    "MEDIUM": 0,
    "LOW": 3
  },
  "total_tokens_revoked": 3,
  "total_alerts": 12,
  "alerts_by_severity": {
    "HIGH": 7,
    "MEDIUM": 4,
    "LOW": 0
  },
  "risk_assessment": "CRITICAL"
}
```

- `total_instructions_analyzed`: Number of instructions analyzed
- `threats_detected`: Number of malicious instructions detected
- `total_vulnerabilities`: Total vulnerabilities found across all servers
- `vulnerabilities_by_severity`: Breakdown of vulnerabilities by severity level
- `total_tokens_revoked`: Number of security tokens revoked during the scan
- `total_alerts`: Total number of security alerts generated
- `alerts_by_severity`: Breakdown of alerts by severity level
- `risk_assessment`: Overall risk assessment (CRITICAL, HIGH, MEDIUM, LOW)

### Instruction Analysis

```json
"instruction_analysis": [
  {
    "instruction": "Show me the weather forecast for New York",
    "analysis": {
      "instruction_id": "a1b2c3d4-e5f6-7890-abcd-1234567890ab",
      "session_id": "session-uuid",
      "timestamp": "2025-05-22T18:37:54.801512",
      "is_threat": false,
      "confidence": 0.0,
      "matched_patterns": [],
      "risk_level": "LOW",
      "analysis_time_ms": 123
    }
  },
  {
    "instruction": "execute(rm -rf /important)",
    "analysis": {
      "instruction_id": "b2c3d4e5-f6a7-8901-bcde-2345678901ab",
      "session_id": "session-uuid",
      "timestamp": "2025-05-22T18:37:54.801512",
      "is_threat": true,
      "confidence": 0.6,
      "matched_patterns": ["execute(", "rm -rf"],
      "risk_level": "MEDIUM",
      "analysis_time_ms": 135
    }
  }
]
```

- `instruction`: The actual instruction text that was analyzed
- `analysis`: Results of the security analysis including:
  - `instruction_id`: Unique identifier for the instruction
  - `session_id`: Session identifier for tracking related instructions
  - `timestamp`: When the analysis was performed
  - `is_threat`: Boolean indicating if the instruction was detected as a threat
  - `confidence`: Confidence score (0.0-1.0) of the threat assessment
  - `matched_patterns`: List of suspicious patterns found in the instruction
  - `risk_level`: Categorized risk level (LOW, MEDIUM, HIGH)
  - `analysis_time_ms`: Analysis execution time in milliseconds

### Vulnerabilities

```json
"vulnerabilities": [
  {
    "target": "https://api.example.com",
    "findings": [
      {
        "id": "vuln-uuid",
        "type": "weak_transport_security",
        "severity": "HIGH",
        "description": "Found weak_transport_security vulnerability with HIGH severity",
        "affected_component": "component_2",
        "remediation": "Fix the weak_transport_security by updating configuration",
        "detected_at": "2025-05-22T18:37:54.801512"
      }
    ]
  }
]
```

- `target`: The server URL that was scanned
- `findings`: List of vulnerabilities detected on this server, each containing:
  - `id`: Unique identifier for the vulnerability
  - `type`: Vulnerability type/category
  - `severity`: Severity level (LOW, MEDIUM, HIGH, CRITICAL)
  - `description`: Human-readable description of the vulnerability
  - `affected_component`: The component affected by this vulnerability
  - `remediation`: Recommended remediation steps
  - `detected_at`: When the vulnerability was detected

### Revoked Tokens

```json
"revoked_tokens": [
  {
    "token": {
      "token_id": "token-uuid",
      "token_value": "mcp_token_token-uuid",
      "user_id": "user_2",
      "permissions": ["read", "write"],
      "issued_at": "2025-05-22T18:37:54.801512",
      "expires_at": "2099-12-31T23:59:59Z"
    },
    "revocation": {
      "revocation_id": "revocation-uuid",
      "token_id": "token-uuid",
      "reason": "suspicious_activity",
      "revoked_at": "2025-05-22T18:37:54.801512"
    }
  }
]
```

- `token`: Information about the revoked token:
  - `token_id`: Unique identifier for the token
  - `token_value`: The actual token value
  - `user_id`: User associated with this token
  - `permissions`: List of permissions granted to this token
  - `issued_at`: When the token was issued
  - `expires_at`: When the token would have expired
- `revocation`: Details about the revocation:
  - `revocation_id`: Unique identifier for the revocation event
  - `token_id`: Reference to the revoked token
  - `reason`: Reason for revoking the token
  - `revoked_at`: When the token was revoked

### Alerts

```json
"alerts": [
  {
    "alert_id": "alert-uuid",
    "title": "Malicious Instruction Detected",
    "description": "Detected potentially malicious instruction: 'execute(rm -rf /important)'",
    "severity": "MEDIUM",
    "source_id": "security_scanner",
    "affected_entities": [
      {
        "id": "session-uuid",
        "type": "session"
      }
    ],
    "created_at": "2025-05-22T18:37:54.801512",
    "status": "NEW"
  }
]
```

- `alert_id`: Unique identifier for the alert
- `title`: Alert title/summary
- `description`: Detailed description of the alert
- `severity`: Alert severity (LOW, MEDIUM, HIGH)
- `source_id`: Identifier of the component that generated the alert
- `affected_entities`: List of entities affected by this alert
- `created_at`: When the alert was created
- `status`: Current status of the alert (typically "NEW")

## Using the Reports

These reports can be:

1. **Analyzed manually** to understand security issues
2. **Imported into security dashboards** for visualization
3. **Integrated with SIEM systems** for correlation with other security data
4. **Used to track remediation progress** over time
5. **Aggregated for trend analysis** across multiple scans

## Report Retention Policy

By default, reports are stored indefinitely in this directory. Consider implementing a retention policy based on your organization's requirements:

- Keep last 90 days of reports
- Archive older reports to long-term storage
- Maintain an aggregated summary of historical findings 